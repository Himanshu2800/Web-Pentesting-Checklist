# SSRF ( Server-Side-Request-Forgery)
* What's SSRF ??
  A Server-Side Request Forgery (SSRF) attack involves an attacker abusing server functionality to access or modify resources. The attacker targets an application that supports data imports from URLs or allows them to read data from URLs.

## What is its impact?

A malicious actor can retrieve the content of arbitrary files on the system, which leads to sensitive information exposure(passwords, source code, confidential data, etc.).

1. Sensitive Data Exposure
2. Unauthenticated Requests
3. Port Scans or Cross Site Port Attack (XSPA)
4. Protocol Smuggling

## **Key Points To Test SSRF Vulnerability :**

1. Always make sure that you are making request to back end server on the behalf of public server not from the browser.
2. To fetch the data from server also try http://localhost/xyz/Â with the http://127.0.0.1/xyz.
3. Server may have the firewall protection always try to bypass the firewall if possible.
4. Make sure that request is coming from server not from your local host.


## Where to look for ??
Source Code Review:
1.Review the application's source code to identify areas where user-supplied input is used to construct URLs or make requests. Look for functions or methods that involve making HTTP requests, such as curl, file_get_contents, fetch, etc. Check how user inputs are used in these functions.
Input Points Identification:

2.Identify places in the application where user input can be used to specify URLs, including URL parameters, request headers, or even parts of the URL path.
Manual Testing:

3.Manually test each input point with payloads that could lead to SSRF, such as URLs with internal IP addresses, localhost, or other reserved IP ranges. Observe the behavior of the application. If the application makes requests to these payloads and returns responses, it might be vulnerable to SSRF.
URL Manipulation:

4.Test for URL manipulation by modifying parameters and parts of the URL to see if you can control the destination of the request. Try using various URL schemes (e.g., file, data, gopher) to see if the application processes them.
Host Header Manipulation:

5.Manipulate the Host header to test if the application sends requests to the specified host. If it does, you might have found an SSRF vulnerability.
Protocol Testing:

6.Test different protocols (http, https, ftp, etc.) to see if the application can be tricked into making requests to unexpected services.
Boundary Testing:

7.Test how the application handles different boundaries. Use long URLs, encoded URLs, and special characters to see if the application behaves unexpectedly.
Automated Scanners:

8.Use automated security scanning tools designed to detect SSRF vulnerabilities. Tools like Burp Suite, OWASP ZAP, and Nmap can help you identify potential SSRF points.

9.Payload Lists:
Utilize lists of known payloads for SSRF testing. These lists often contain various payloads that have been used successfully to exploit SSRF vulnerabilities in the past.

10.Response Analysis:
Analyze the responses from the application. If the application returns responses from internal services or you observe behaviors that suggest SSRF, you might have found a vulnerability.

11.Reporting:
Once you identify a potential SSRF vulnerability, report it to the appropriate parties, such as the application owner or the security team, following responsible disclosure practices.

## AWS Metadata
Most of the sites use AWS nowadays...

* AWS localhost is 169.254.169.254 so don't use 127.0.0.1 there!

* If you found an SSRF vulnerability that runs on EC2, try requesting :
```
http://169.254.169.254/latest/meta-data/
http://169.254.169.254/latest/user-data/
http://169.254.169.254/latest/meta-data/iam/security-credentials/IAM_USER_ROLE_HERE
http://169.254.169.254/latest/meta-data/iam/security-credentials/flaws/
```

## Escalation

* SSRF can be Escalated to RCE
* `<os cmd>`.collaborator.net 
* If there's no impact! on your SSRF rather than a redirect try to escalate it to XSS.
